-- ID/PW: rudql / 1234
DROP TABLE STATUS;

CREATE TABLE STATUS(
    S_CODE VARCHAR2(5)
    , S_CODENAME VARCHAR2(50)
    , CONSTRAINT S_CODE_PK PRIMARY KEY(S_CODE)
);

INSERT INTO STATUS VALUES('S00', '전체');
INSERT INTO STATUS VALUES('S01', '접수');
INSERT INTO STATUS VALUES('S02', '승인');
INSERT INTO STATUS VALUES('S03', '지급완료');
INSERT INTO STATUS VALUES('S04', '반려');

DROP TABLE USAGE;

CREATE TABLE USAGE(
    U_CODE VARCHAR2(5)
    , U_CODENAME VARCHAR2(50)
    , CONSTRAINT U_CODE_PK PRIMARY KEY(U_CODE)
);


INSERT INTO USAGE VALUES('U00', '전체');
INSERT INTO USAGE VALUES('U01', '식대(야근)');
INSERT INTO USAGE VALUES('U02', '택시비(야근)');
INSERT INTO USAGE VALUES('U03', '택시비(회식)');
INSERT INTO USAGE VALUES('U04', '사무용품 구매');
INSERT INTO USAGE VALUES('U05', '교육비');
INSERT INTO USAGE VALUES('U06', '접대비');

DROP TABLE COST;

CREATE TABLE COST(
    ID VARCHAR2(10) 
    , USAGE_DATE DATE
    , S_CODE VARCHAR2(5)
    , USAGE_COST NUMBER
    , U_CODE VARCHAR2(5)
    , OK_COST NUMBER
    , REG_DATE DATE
    , RECEIPT_O VARCHAR2(200)
    , RECEIPT_R VARCHAR2(200)
    , PROCESSING_DATE DATE
    , NOTE VARCHAR2(500)
    , CONSTRAINT ID_PK PRIMARY KEY(ID)
    , CONSTRAINT S_CODE_FK FOREIGN KEY(S_CODE) REFERENCES STATUS(S_CODE)
    , CONSTRAINT U_CODE_FK FOREIGN KEY(U_CODE) REFERENCES USAGE(U_CODE)
);

DROP SEQUENCE ID_SEQ;

CREATE SEQUENCE ID_SEQ;

INSERT INTO COST
VALUES(ID_SEQ.NEXTVAL, SYSDATE, 'S02', 15000, 'U03', 9000, '2020/03/02', '영수증 원본.jpg', '영수증 복사본.jpg', SYSDATE, '비고입니다');

UPDATE COST SET U_CODE = 'U04'
                            , S_CODE= 'S04'
WHERE ID = '1';

COMMIT;

SELECT  ID
            , USAGE_DATE
            , A.S_CODE
            , S_CODENAME
            , USAGE_COST
            , OK_COST
            , A.U_CODE
            , U_CODENAME
            , REG_DATE
FROM COST A
INNER JOIN STATUS B ON A.S_CODE = B.S_CODE
INNER JOIN USAGE C ON A.U_CODE = C.U_CODE
WHERE TO_CHAR(USAGE_DATE, 'YYYY/MM')  LIKE '2020/02'
ORDER BY USAGE_DATE DESC, ID DESC
;

SELECT * FROM COST;

CREATE TABLE IDS(TABLE_NAME VARCHAR(16) NOT NULL PRIMARY KEY,NEXT_ID DECIMAL(30) NOT NULL);
INSERT INTO IDS VALUES('SAMPLE',115)